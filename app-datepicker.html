<dom-module id="app-datepicker">
  <template strip-whitespace>
    <style>
      :host {
        display: block;
        box-sizing: border-box;
        width: calc(100% - (var(--horizontal-margin) * 2));
        height: calc(100% - (var(--vertical-margin) * 2));
        max-width: var(--max-content-container-width);
        max-height: var(--max-content-container-height);
        border-radius: 2px;
        font-size: 14px;

        /*position: fixed;*/
        /*height: 100%;
        width: 100%;
        top: 0;
        left: 0;*/
        /*background-color: rgba(0, 0, 0, .45);*/

        --default-datepicker-primary-color: #4285f4;

        --vertical-margin: 40px;
        --horizontal-margin: 16px;
        --max-content-container-width: 252px;
        --max-content-container-height: 424px;

        --selected-year-color: #c7dbFc;
        --selected-date-color: #fff;
      }

      * {
        box-sizing: border-box;
        -webkit-tap-highlight-color: rgba(0, 0, 0, 0);
        font-size: 14px;
      }

      button {
        -webkit-appearance: none;
        -moz-appearance: none;
        appearance: none;

        padding: 0;
        margin: 0;
        border: none;
        font-size: inherit;
        color: inherit;
        background-color: inherit;
      }
      button:hover {
        cursor: pointer;
      }

      .content-container {
        display: grid;
        grid-template-rows: 80px 295px 49px;

        display: -ms-grid;
        -ms-grid-rows: 80px 295px 49px;
        -ms-grid-columns: 0 1fr 0;

        /*display: flex;*/
        /*flex-direction: column;*/

        /*position: relative;
        width: calc(100% - (var(--horizontal-margin) * 2));
        height: calc(100% - (var(--vertical-margin) * 2));
        max-width: var(--max-content-container-width);
        max-height: var(--max-content-container-height);
        top: 50%;
        left: 50%;
        transform: translate3d(-50%, -50%, 0);
        background-color: #fff;
        box-shadow: 0 16px 24px 2px rgba(0, 0, 0, 0.14),
                    0  6px 30px 5px rgba(0, 0, 0, 0.12),
                    0  8px 10px -5px rgba(0, 0, 0, 0.4);*/
      }

      .header,
      .main,
      .footer {
        position: relative;
      }

      .header {
        display: grid;
        grid-template-rows: minmax(0, 28px) minmax(0, 44px);
        grid-template-columns: 14px auto 14px;

        -ms-grid-row: 1;
        -ms-grid-column: 2;
        display: -ms-grid;
        -ms-grid-rows: minmax(0, 28px) minmax(0, 44px);
        -ms-grid-columns: 14px auto 14px;

        background-color: var(--datepicker-primary-color, var(--default-datepicker-primary-color));
        /*flex: 1;*/
      }
      .header > .selected-year:hover,
      .header > .selected-date:hover {
        cursor: pointer;
      }
      .header > .selected-year {
        grid-row: 1;
        grid-column: 2;
        justify-self: start;

        -ms-grid-row: 1;
        -ms-grid-column: 2;
        -ms-grid-column-align: start;

        position: relative;
        padding: 6px;
        top: 12px;
        left: -6px;
        background-color: rgba(0, 0, 0, 0);
        color: var(--selected-year, var(--selected-year-color));
      }
      .header > .selected-date {
        grid-row: 2;
        grid-column: 2;
        justify-self: start;

        -ms-grid-row: 2;
        -ms-grid-column: 2;
        -ms-grid-column-align: start;

        font-size: 28px;
        background-color: rgba(0, 0, 0, 0);
        color: var(--selected-date, var(--selected-date-color));
      }
      .header > .selected-date > .selected-day {}
      .header > .selected-date > .selected-month-date {}

      .main {
        /*flex: 5 1 auto;*/

        -ms-grid-row: 2;
        -ms-grid-column: 2;

        background-color: #f1f1f1;
      }

      .main > .calendar-view,
      .main > .year-view {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        opacity: 1;
      }

      /*.main > .calendar-view {
        opacity: 0;
        pointer-events: none;
      }*/

      .main > .year-view {
        opacity: 0;
        pointer-events: none;
        margin: 0;
        padding: 0;
      }
      .main > .year-view > .li-year {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: center;
        justify-content: center;

        display: grid;
        align-items: center;
        justify-items: center;

        width: 100%;
        height: 42px;
        font-weight: 700;
        color: #212121;
        list-style-type: none;
      }
      .main > .year-view > .li-year-selected {
        color: var(--li-year-selected-color, var(--default-datepicker-primary-color));
        font-size: 22px;
      }

      .main > .calendar-view > .month-navigator {
        display: -ms-grid;
        -ms-grid-columns: 59px 1fr 59px;
        -ms-grid-rows: 59x;
        -ms-grid-row-align: center;
        -ms-grid-column-align: center;

        display: grid;
        grid-template-columns: 59px auto 59px;
        grid-template-rows: 59px;
        align-items: center;
        justify-items: center;
      }
      .main > .calendar-view > .month-navigator > .chevron-left-button,
      .main > .calendar-view > .month-navigator > .chevron-right-button {
        position: relative;
        width: 59px;
        height: 59px;
        padding: calc((59px - 24px) / 2);
        background-repeat: no-repeat;
        background-position: 50% 50%;
      }
      .main > .calendar-view > .month-navigator > .chevron-left-button {
        /*left: 3px;*/
        -ms-grid-row: 1;
        -ms-grid-column: 1;

        background-image: url('/image/ic_chevron_left_black_24px.svg');
      }
      .main > .calendar-view > .month-navigator > .selected-month-year {
        display: grid;
        justify-items: center;

        -ms-grid-row: 1;
        -ms-grid-column: 2;
        display: -ms-grid;
        -ms-grid-row-align: center;
        -ms-grid-column-align: center;

        font-weight: 700;
      }
      .main > .calendar-view > .month-navigator > .chevron-right-button {
        /*right: 3px;*/
        -ms-grid-row: 1;
        -ms-grid-column: 3;

        background-image: url('/image/ic_chevron_right_black_24px.svg');
      }

      .main > .calendar-view > .weekdays-container {
        display: grid;
        grid-template-columns: repeat(7, minmax(0, 34px));
        grid-template-rows: minmax(0, 34px);
        align-items: center;
        justify-items: center;

        display: -ms-grid;
        -ms-grid-rows: 59px;
        -ms-grid-rows: 34px;
        -ms-grid-columns: (minmax(0, 34px))[7];

        position: relative;
        top: -4px;
        padding: 0 16px;
        color: #757575;
        font-weight: 700;
      }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(n) {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: center;
        justify-content: center;

        display: grid;

        width: 34px;
        height: 34px;
      }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(1) { -ms-grid-row: 1; -ms-grid-column: 1; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(2) { -ms-grid-row: 1; -ms-grid-column: 2; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(3) { -ms-grid-row: 1; -ms-grid-column: 3; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(4) { -ms-grid-row: 1; -ms-grid-column: 4; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(5) { -ms-grid-row: 1; -ms-grid-column: 5; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(6) { -ms-grid-row: 1; -ms-grid-column: 6; }
      .main > .calendar-view > .weekdays-container > div:nth-of-type(7) { -ms-grid-row: 1; -ms-grid-column: 7; }

      .main > .calendar-view > .dates-container {
        display: grid;
        grid-template-columns: repeat(7, minmax(0, 34px));
        grid-template-rows: repeat(6, minmax(0, 34px));
        align-items: center;
        justify-items: center;

        display: -ms-grid;
        -ms-grid-rows: (minmax(0, 34px))[7];
        -ms-grid-columns: (minmax(0, 34px))[6];
        -ms-grid-row-align: center;
        -ms-grid-column-align: center;

        position: relative;
        top: -3px;
        padding: 0 16px;
        font-weight: 700;
      }
      .main > .calendar-view > .dates-container > div:nth-of-type(n):empty {
        background-color: inherit;
        color: inherit;
      }
      .main > .calendar-view > .dates-container > div:nth-of-type(n) {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: center;
        align-items: center;
        -ms-flex-pack: center;
        justify-content: center;

        display: grid;

        width: 34px;
        height: 34px;
        border-radius: 50%;
      }
      /* TODO: selected > today > disable*/
      .main > .calendar-view > .dates-container > div.is-disable {
        color: #9e9e9e;
      }
      .main > .calendar-view > .dates-container > div.is-today {
        color: var(--default-datepicker-primary-color);
      }
      /*.main > .calendar-view > .dates-container > div.is-selected {
        background-color: var(--default-datepicker-primary-color);
        color: #fff;
      }*/
      .main > .calendar-view > .dates-container > div:nth-of-type(7n) { -ms-grid-column: 7; }
      .main > .calendar-view > .dates-container > div:nth-of-type(7n - 1) { -ms-grid-column: 6; }
      .main > .calendar-view > .dates-container > div:nth-of-type(7n - 2) { -ms-grid-column: 5; }
      .main > .calendar-view > .dates-container > div:nth-of-type(7n - 3) { -ms-grid-column: 4; }
      .main > .calendar-view > .dates-container > div:nth-of-type(7n - 4) { -ms-grid-column: 3; }
      .main > .calendar-view > .dates-container > div:nth-of-type(7n - 5) { -ms-grid-column: 2; }
      .main > .calendar-view > .dates-container > div:nth-of-type(n + 8) { -ms-grid-row: 2; }
      .main > .calendar-view > .dates-container > div:nth-of-type(n + 15) { -ms-grid-row: 3; }
      .main > .calendar-view > .dates-container > div:nth-of-type(n + 22) { -ms-grid-row: 4; }
      .main > .calendar-view > .dates-container > div:nth-of-type(n + 29) { -ms-grid-row: 5; }
      .main > .calendar-view > .dates-container > div:nth-of-type(n + 36) { -ms-grid-row: 6; }

      .buttons-container {
        /*flex: 1;*/
        display: -ms-grid;
        -ms-grid-columns: 1fr (minmax(0, 59px))[2] 10px;
        -ms-grid-rows: (minmax(0, 1fr))[3];

        display: grid;
        grid-template-columns: auto repeat(2, minmax(0, 59px)) 10px;
        align-items: center;
        justify-items: end;

        -ms-grid-row: 3;
        -ms-grid-column: 2;

        background-color: #fff;
      }
      .buttons-container > .ok-button,
      .buttons-container > .cancel-button {
        display: grid;
        align-items: center;
        justify-content: center;

        width: 59px;
        margin: 0;
        padding: 3px 0;
        font-weight: 700;
        background-color: #fff;
        color: var(--datepicker-primary-color, var(--default-datepicker-primary-color));
        text-transform: uppercase;
      }
      .buttons-container > button:focus {
        background-color: #e1e1e1;
      }
      .buttons-container > .cancel-button {
        -ms-grid-row: 2;
        -ms-grid-column: 2;

        grid-column: 2;
      }
      .buttons-container > .ok-button {
        -ms-grid-row: 2;
        -ms-grid-column: 3;

        grid-column: 3;
      }

    </style>

    <div class="content-container">
      <div class="header">
        <button class="selected-year">[[activeDateObject.longFullYear]]</button>
        <button class="selected-date">[[activeDateObject.shortWeekday]], [[activeDateObject.shortMonth]] [[activeDateObject.shortDay]]</button>
      </div>
      <div class="main">
        <div class="calendar-view">
          <div class="month-navigator">
            <button class="chevron-left-button"></button>
            <div class="selected-month-year">[[activeDateObject.longMonth]] [[activeDateObject.longFullYear]]</div>
            <button class="chevron-right-button"></button>
          </div>

          <div class="weekdays-container">
              <template is="dom-repeat" strip-whitespace items="[[activeDateObject.weekdays]]">
                <div class$="weekday-[[index]]" aria-label$="[[item.weekdayLabel]]">[[item.weekday]]</div>
              </template>
          </div>

          <div class="dates-container">
            <template is="dom-repeat" strip-whitespace items="[[activeDateObject.daysOfMonth]]">
              <div class$="date-[[item.dateIndex]] [[item.today]] [[item.disable]]" aria-label$="[[item.dateLabel]]" style$="[[item.overrideStyle]]">[[item.date]]</div>
            </template>
          </div>
        </div>
        <ol class="year-view">
          <li class="li-year year-2014">2014</li>
          <li class="li-year year-2014">2015</li>
          <li class="li-year year-2014">2016</li>
          <li class="li-year li-year-selected year-2014">2017</li>
          <li class="li-year year-2014">2018</li>
          <li class="li-year year-2014">2019</li>
          <li class="li-year year-2014">2020</li>
        </ol>
      </div>
      <div class="buttons-container">
        <button class="cancel-button">cancel</button>
        <button class="ok-button">ok</button>
      </div>
    </div>

  </template>
</dom-module>

<script src="app-datepicker.js"></script>
